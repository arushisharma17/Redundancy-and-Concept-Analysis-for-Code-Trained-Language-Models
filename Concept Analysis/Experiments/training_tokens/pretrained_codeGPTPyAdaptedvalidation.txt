def
verified_excel_file
store
institute_list
temp_excel_dir
document_lines
written_files
today
strftime
'%Y-%m-%d'
for
cust
institute_list
verif_vars
store
verified
institute_id
cust
if
not
verif_vars
unique_callers
for
var_type
var_callers
CALLERS
for
caller
var_callers
unique_callers
caller
cust_verified
export_verified_variants
verif_vars
unique_callers
document_name
cust
'_verified_variants'
today
'.xlsx'
workbook
Workbook
temp_excel_dir
document_name
Report_Sheet
workbook
add_worksheet
for
col
field
VERIFIED_VARIANTS_HEADER
unique_callers
Report_Sheet
col
field
workbook
if
exists
temp_excel_dir
document_name
written_files
written_files
def
build_hpo_term
hpo_info
try
hpo_id
hpo_info
'hpo_id'
description
hpo_info
hpo_obj
HpoTerm
hpo_id
hpo_id
description
description
hgnc_ids
hpo_info
'genes'
if
hgnc_ids
hpo_obj
'genes'
hgnc_ids
hpo_obj
def
export_genes
adapter
build
'37'
for
gene_obj
adapter
all_genes
build
build
yield
gene_obj
def
parse_clnsig
acc
sig
revstat
transcripts
clnsig_accsessions
if
acc
try
acc
acc
if
acc
revstat_groups
if
revstat
revstat_groups
rev
lstrip
for
rev
revstat
sig_groups
if
sig
for
significance
sig
splitted_word
significance
for
sign_term
sig_groups
clnsig_accsessions
sign_term
'accession'
acc
acc_groups
acc
sig_groups
sig
revstat_groups
revstat
for
acc_group
sig_group
revstat_group
acc_groups
sig_groups
revstat_groups
accessions
acc_group
significances
sig_group
revstats
revstat_group
for
accession
significance
revstat
accessions
significances
revstats
significance
'accession'
accession
'revstat'
revstat
transcripts
clnsig
for
transcript
transcripts
for
annotation
transcript
'clinsig'
clnsig
annotation
for
annotation
clnsig
clnsig_accsessions
annotation
clnsig_accsessions
def
context
collection_name
adapter
context
obj
click
echo
"collection\\tindex"
for
collection_name
adapter
collections
for
adapter
collection_name
click
echo
"{0}\\t{1}"
collection_name
if
def
groups
context
institute_id
phenotype_group
group_abbreviation
group_file
if
group_file
phenotype_group
group_abbreviation
for
group_file
if
if
phenotype_group
if
group_abbreviation
if
not
phenotype_group
if
phenotype_group
group_abbreviation
if
not
phenotype_group
group_abbreviation
adapter
update_institute
internal_id
institute_id
phenotype_groups
phenotype_group
group_abbreviations
group_abbreviation
add_groups
def
parse_compounds
compound_info
case_id
variant_type
compounds
if
compound_info
for
family_info
compound_info
splitted_entry
family_info
if
splitted_entry
case_id
for
compound
splitted_entry
splitted_compound
compound
compound_obj
compound_name
splitted_compound
compound_obj
'variant'
generate_md5_key
compound_name
variant_type
case_id
compound_score
splitted_compound
TypeError
IndexError
compound_score
compound_obj
compound_score
compound_obj
'display_name'
compound_name
compounds
compound_obj
compounds
def
genes
context
build
adapter
all_genes
build
build
if
click
echo
gene_string
"{0}\\t{1}\\t{2}\\t{3}\\t{4}"
click
echo
"#Chromosom\\tStart\\tEnd\\tHgnc_id\\tHgnc_symbol"
for
gene_obj
click
echo
gene_string
gene_obj
'chromosome'
gene_obj
gene_obj
gene_obj
'hgnc_id'
gene_obj
'hgnc_symbol'
def
build_individual
ind
ind_obj
individual_id
ind
'individual_id'
as
err
ind_obj
'display_name'
ind
'display_name'
ind_obj
'individual_id'
sex
ind
'sex'
sex
ind_obj
'sex'
sex
as
err
ind_obj
'sex'
REV_SEX_MAP
sex
phenotype
ind
'phenotype'
ped_phenotype
REV_PHENOTYPE_MAP
phenotype
if
ped_phenotype
ped_phenotype
ind_obj
'phenotype'
ped_phenotype
ind_obj
'father'
ind
'father'
ind_obj
'mother'
ind
'mother'
ind_obj
'capture_kits'
ind
'capture_kits'
ind_obj
'bam_file'
ind
'bam_file'
ind_obj
'mt_bam'
ind
'mt_bam'
ind_obj
'vcf2cytosure'
ind
'vcf2cytosure'
ind_obj
'confirmed_sex'
ind
'confirmed_sex'
ind_obj
'confirmed_parent'
ind
'confirmed_parent'
ind_obj
'predicted_ancestry'
ind
'predicted_ancestry'
analysis_type
ind
'analysis_type'
if
not
analysis_type
ANALYSIS_TYPES
ind_obj
'analysis_type'
analysis_type
if
'tmb'
ind
ind_obj
'tmb'
ind
'tmb'
if
'msi'
ind
ind_obj
'msi'
ind
'msi'
if
'tumor_purity'
ind
ind_obj
'tumor_purity'
ind
'tumor_purity'
if
'tumor_type'
ind
ind_obj
'tumor_type'
ind
'tumor_type'
ind_obj
def
variants
context
case_id
institute
cancer
cancer_research
sv
sv_research
snv
snv_research
str_clinical
chrom
start
end
hgnc_id
hgnc_symbol
rank_treshold
if
institute
case_id
"{0}-{1}"
institute
case_id
institute
case_id
case_obj
adapter
case
case_id
case_id
if
case_obj
context
abort
'category'
'cancer'
'variant_type'
'clinical'
'upload'
cancer
'category'
'cancer'
'variant_type'
'research'
'upload'
cancer_research
'category'
'sv'
'variant_type'
'clinical'
'upload'
sv
'category'
'sv'
'variant_type'
'research'
'upload'
sv_research
'category'
'snv'
'variant_type'
'clinical'
'upload'
snv
'category'
'snv'
'variant_type'
'research'
'upload'
snv_research
'category'
'variant_type'
'clinical'
'upload'
str_clinical
gene_obj
if
hgnc_id
or
hgnc_symbol
if
hgnc_id
gene_obj
adapter
hgnc_gene
hgnc_id
if
hgnc_symbol
for
adapter
gene_by_alias
hgnc_symbol
gene_obj
if
not
gene_obj
for
file_type
variant_type
file_type
'variant_type'
category
file_type
'category'
if
file_type
'upload'
if
variant_type
'research'
if
not
or
case_obj
'research_requested'
variant_type
category
case_id
adapter
delete_variants
case_id
case_obj
'_id'
variant_type
variant_type
category
category
adapter
load_variants
case_obj
case_obj
category
category
rank_threshold
rank_treshold
chrom
chrom
start
start
end
end
gene_obj
gene_obj
as
LOG
warning
if
def
case
institute_id
case_name
institute_obj
case_obj
institute_and_case
store
institute_id
case_name
abort
json_util
case_obj
def
variant
institute_id
case_name
variant_id
variant_obj
store
variant
variant_id
json_util
variant_obj
def
collections
context
click
echo
collection_name
def
institute
ctx
internal_id
display_name
sanger_recipients
adapter
ctx
obj
if
not
internal_id
ctx
abort
if
not
display_name
display_name
internal_id
if
sanger_recipients
sanger_recipients
sanger_recipients
try
load_institute
adapter
adapter
internal_id
internal_id
display_name
display_name
sanger_recipients
sanger_recipients
warning
def
institute
context
institute_id
sanger_recipient
coverage_cutoff
frequency_cutoff
display_name
remove_sanger
adapter
update_institute
sanger_recipient
sanger_recipient
coverage_cutoff
coverage_cutoff
frequency_cutoff
frequency_cutoff
remove_sanger
remove_sanger
as
err
LOG
warning
err
def
get_file_handle
if
file_handle
getreader
errors
'replace'
file_handle
file_handle
def
parse_case_data
config
ped
owner
vcf_snv
vcf_sv
vcf_cancer
vcf_str
peddy_ped
peddy_sex
peddy_check
delivery_report
multiqc
config_data
deepcopy
config
or
if
'analysis_date'
not
config_data
config_data
'analysis_date'
if
ped
family_id
samples
parse_ped
ped
config_data
'family'
family_id
config_data
samples
if
'owner'
not
config_data
if
not
owner
config_data
'owner'
owner
if
'gene_panels'
config_data
config_data
'gene_panels'
panel
for
panel
config_data
'gene_panels'
config_data
'default_gene_panels'
panel
for
panel
config_data
'default_gene_panels'
config_data
'peddy_ped'
peddy_ped
or
config_data
'peddy_ped'
config_data
'peddy_sex_check'
peddy_sex
or
config_data
'peddy_sex'
config_data
'peddy_ped_check'
peddy_check
or
config_data
'peddy_check'
add_peddy_information
config_data
config_data
'multiqc'
multiqc
or
config_data
'multiqc'
config_data
'vcf_snv'
vcf_snv
if
vcf_snv
config_data
'vcf_snv'
config_data
'vcf_sv'
vcf_sv
if
vcf_sv
'vcf_sv'
'vcf_str'
if
'vcf_str'
'vcf_cancer'
if
'vcf_cancer'
'delivery_report'
if
'delivery_report'
'rank_model_version'
'rank_model_version'
'rank_score_threshold'
'rank_score_threshold'
'track'
'track'
'rare'
if
'vcf_cancer'
'track'
'cancer'
def
if
'peddy_ped'
'peddy_ped'
for
'sample_id'
if
'peddy_ped_check'
'peddy_ped_check'
for
'sample_a'
'sample_b'
if
'peddy_sex_check'
'peddy_sex_check'
for
'sample_id'
if
not
for
'sample_id'
for
if
'predicted_ancestry'
'ancestry-prediction'
if
if
'confirmed_sex'
'confirmed_sex'
for
'mother'
'father'
if
for
if
if
'parent_error'
'confirmed_parent'
if
'confirmed_parent'
not
'confirmed_parent'
def
if
'sample_id'
not
'sample_id'
if
'sex'
not
'sex'
if
not
if
'phenotype'
not
'phenotype'
if
not
'individual_id'
'display_name'
'sample_name'
'sample_id'
'sex'
'phenotype'
'father'
'father'
'mother'
'mother'
'confirmed_parent'
'confirmed_parent'
'confirmed_sex'
'confirmed_sex'
'predicted_ancestry'
'predicted_ancestry'
'bam_path'
if
'bam_file'
'mt_bam'
if
'mt_bam'
'analysis_type'
if
'analysis_type'
'capture_kits'
'capture_kit'
if
'capture_kit'
'vcf2cytosure'
if
'vcf2cytosure'
'tumor_type'
if
'tumor_type'
'tmb'
if
'tmb'
'msi'
if
'msi'
'tumor_purity'
if
'tumor_purity'
def
if
for
'individual_id'
for
'father'
if
if
not
'mother'
if
if
not
def
if
'owner'
not
if
'family'
not
'owner'
'owner'
'collaborators'
'owner'
'case_id'
'family'
'display_name'
'family_name'
'family'
'genome_build'
'human_genome_build'
'rank_model_version'
'rank_model_version'
'rank_score_threshold'
'rank_score_threshold'
'analysis_date'
'analysis_date'
'individuals'
'vcf_files'
'vcf_snv'
'vcf_snv'
'vcf_sv'
'vcf_sv'
'vcf_str'
'vcf_str'
'vcf_cancer'
'vcf_cancer'
'vcf_snv_research'
'vcf_snv_research'
'vcf_sv_research'
'vcf_sv_research'
'vcf_cancer_research'
'vcf_cancer_research'
'default_panels'
'default_gene_panels'
'gene_panels'
'gene_panels'
'assignee'
'assignee'
'peddy_ped'
'peddy_ped'
'peddy_sex'
'peddy_sex'
'peddy_check'
'peddy_check'
'delivery_report'
'delivery_report'
'multiqc'
'multiqc'
'track'
'track'
'rare'
if
'madeline'
'madeline'
if
not
with
as
'madeline_info'
if
'vcf_files'
'vcf_cancer'
or
'vcf_files'
'vcf_cancer_research'
'track'
'cancer'
def
'ped'
if
'sample_id'
'father'
'mother'
'sex'
'phenotype'
for
def
or
for
'term'
'term'
if
'comment'
'comment'
'comment'
if
'criteria'
def
'chrom'
'MT'
if
not
'individuals'
if
not
'%Y-%m-%d'
if
not
for
'individual_id'
'display_name'
'.xlsx'
if
for
if
if
def
'individual_id'
'display_name'
'genotype_call'
'ref_depth'
'alt_depth'
'read_depth'
'genotype_quality'
def
if
if
if
if
if
if
if
if
if
if
def
if
if
if
def
if
if
if
def
'uncertain_significance'
for
if
'PVS'
'PS'
'PM'
'PP'
'BA'
'BS'
'BP'
if
or
if
or
'uncertain_significance'
'pathogenic'
'likely_pathogenic'
if
'benign'
if
'likely_benign'
def
or
'has_refseq'
for
for
'genes'
'hgnc_id'
if
not
for
'genes'
'hgnc_id'
if
not
for
'transcripts'
'ensembl_transcript_id'
'transcripts_dict'
if
'incomplete_penetrance'
'omim_penetrance'
for
for
'disease_associated_transcripts'
r'\\.[0-9]'
if
'reduced_penetrance'
if
'mosaicism'
'inheritance_models'
'disease_associated_transcripts'
'manual_penetrance'
'mosaicism'
'manual_inheritance'
for
'transcripts'
'transcript_id'
if
not
if
'is_primary'
'is_primary'
if
not
'refseq_id'
'refseq_id'
'refseq_id'
'has_refseq'
if
'is_disease_associated'
'refseq_identifiers'
'refseq_identifiers'
'common'
'disease_terms'
def
'snv'
'variant_rank'
if
if
'variant_rank'
'variant_rank'
if
'rank_score'
'rank_score'
if
def
'validation'
'$exists'
if
'institute_id'
if
'case_id'
def
if
'variant_id'
'_id'
if
if
'chromosome'
'is_par'
'chromosome'
def
'snv'
'clinical'
'rank_score'
if
def
'verb'
'validate'
'institute'
for
'case'
'variant_id'
if
not
or
not
'case_obj'
'display_name'
'display_name'
'individuals'
'individuals'
def
"_id"
for
'causatives'
'$match'
'collaborators'
'causatives'
'$exists'
'$unwind'
'$causatives'
'$group'
'_id'
'$causatives'
'_id'
for
def
'owner'
if
'_id'
if
if
'causatives'
'_id'
'$in'
'variant_id'
'variant_id'
for
'variant_id'
'$in'
if
'case_id'
'_id'
'institute'
'_id'
def
'display_name'
'institute'
for
if
not
'case_id'
'_id'
'display_name'
if
yield
def
or
'case_id'
'variant_type'
if
'category'
def
'snv'
if
'category'
'sv'
'sv'
'$and'
'case_id'
'case_id'
'category'
'hgnc_ids'
'$in'
'hgnc_ids'
'rank_score'
def
'case_id'
'$or'
'acmg_classification'
'$exists'
'manual_rank'
'$exists'
'dismiss_variant'
'$exists'
for
'variant_id'
'case'
'category'
'variant'
'verb'
'comment'
'variant_id'
for
for
if
if
not
'is_commented'
def
'clinical'
'snv'
or
if
'clinical'
if
'snv'
'vcf_files'
'vcf_snv'
'sv'
'vcf_files'
'vcf_sv'
'vcf_files'
'vcf_str'
'research'
'vcf_files'
'vcf_snv_research'
'vcf_files'
'vcf_sv_research'
if
not
if
'chromosome'
if
if
"{0}:{1}-{2}"
"{0}"
or
with
as
for
if
for
def
'snv'
'_id'
'$in'
'$elemMatch'
'display_name'
'genotype_call'
'$regex'
def
27017
or
if
if
"mongodb://{}:{}@{}:{}/{}"
"mongodb://{}:****@{}:{}/{}"
"mongodb://%s:%s"
as
def
'variant'
'casedata'
def
if
'variant'
if
'casedata'
'casedata_'
not
'csv_type'
'case_id'
'case_id'
'category'
'category@'
'@'
if
not
'ref_seq'
'hgvs'
if
'casedata'
'_id'
'case_id'
'individual_id'
'_id'
'case_id'
def
if
'all_vars'
for
if
'local_id'
'local_id@'
def
if
'variant_data'
def
def
'37'
or
if
for
'ensembl_gene_id'
if
not
'hgnc_id'
'hgnc_id'
'primary_transcripts'
'primary_transcripts'
for
'is_primary'
'primary_transcripts'
for
if
not
for
if
'is_primary'
if
not
if
'refseq_id'
if
'refseq_identifiers'
if
def
or
'cust000'
if
or
'omim_api_key'
if
not
if
'OMIM-AUTO'
if
if
or
if
def
'37'
'chrom'
'rank'
'exon_id'
'transcript'
'hgnc_id'
def
if
for
def
for
def
if
not
def
if
def
def
if
not
or
if
if
not
"{0}-{1}"
if
'clinical'
'research'
def
if
for
if
for
for
'individuals'
"#case_id\\tind_id\\tdisplay_name\\tsex\\tphenotype\\tmother\\tfather"
for
for
'individuals'
'_id'
'individual_id'
'display_name'
'sex'
'phenotype'
'mother'
'father'
def
'phenotype_terms'
if
for
'phenotype_id'
'feature'
"observed"
"yes"
def
if
for
'MIM'
def
'genome_build'
if
not
'37'
'38'
'GRCh37'
'GRCh'
'suspects'
for
'hgnc_ids'
if
not
for
'gene'
'hgnc_symbol'
'variant'
'referenceName'
'chromosome'
'assembly'
'referenceBases'
'reference'
'alternateBases'
'alternative'
'shareVariantLevelData'
for
'genotype_call'
'genotype_call'
def
for
if
for
if
for
for
for
if
lambda
def
for
if
not
if
if
for
if
for
if
if
def
if
def
if
if
if
def
if
for
for
def
def
for
if
def
if
not
def
or
def
if
if
if
if
def
if
def
if
if
for
as
for
for
if
if
not
if
def
if
def
if
not
if
def
for
def
if
if
not
if
if
not
if
not
as
if
if
if
not
if
if
if
if
if
not
if
if
if
or
if
if
if
if
or
if
if
if
if
if
if
or
if
if
def
if
not
if
def
if
if
def
if
for
if
if
not
for
for
if
if
not
lambda
for
if
for
yield
for
yield
def
if
for
for
if
for
def
if
def
27017
27017
27017
500
700
2000
1000000
37
37
37
38
38
403
10000
5000
5000
27017
5000
5000
10000
5000
5000
5000
10e10
24.
60.
2000.0
149.597870e6
149.597870e6
24.
60.
0.35
0.45
0.1125
.025
.02
.025
0.075
.025
.05
65
1e3
.95
0xF000F
0x3030303
0x0F0F
211
212
500
7000
0.075
0.435
0.232
0.115
0.0975
0.025
0.22
0.025
0.025
2000
5500
2000
24.
60.
60.
24.
60.
60.
2.9296875
65
187.5
0.04
10000
10000
3600.0
254.
177.
178.
187.
188.
119.
194.
406
204
51
0.33
281
70.6
50.4
0.08
.8
500
3.0
28.0
14.0
0.027
0.032
0.009
0.012
500
1500
17
3600
42
42.0
1.337
424.2
1.01
7.5
110
184
10000
99999999
0.6
5.14
5.14
5.14
360
270
5.7
0.6
0.8
147
147
147
147
0.0349
0.0471
1.4
0.6
5.14
1.4
5.14
1.4
20.08
22.42
25.08
27.58
30.08
32.58
34.92
37.83
40.00
42.67
45.00
47.00
49.75
0.93
0.93
0.93
0.93
1.01
1.17
1.32
1.56
1.87
2.26
2.72
3.35
3.81
4.82
20.08
22.50
25.08
27.58
30.08
32.50
35.00
37.67
40.17
42.67
45.00
47.50
50.00
1.55
1.55
1.71
1.86
2.10
2.33
2.72
3.11
3.81
4.43
5.28
6.14
7.46
9.24
20.00
22.51
25.10
27.69
30.11
32.45
35.04
37.88
40.14
42.65
45.07
47.33
50.08
2.49
2.49
2.64
2.87
3.34
3.81
4.43
5.20
6.29
7.38
9.01
11.11
14.29
19.34
20.00
22.50
25.08
28.00
30.00
32.50
34.92
37.50
40.17
42.42
45.00
47.17
50.08
3.27
3.27
3.74
4.44
5.37
6.07
7.16
8.33
10.04
12.30
15.95
21.17
27.47
40.00
0.6
0.000
0.082
0.206
0.298
0.404
0.509
0.598
0.685
0.772
0.627
0.700
0.794
0.855
0.912
0.948
0.968
0.983
0.997
0.000
0.082
0.206
0.298
0.404
0.509
0.598
0.685
0.772
0.333
0.667
1.584
1.444
1.389
1.311
1.193
1.109
1.446
1.342
1.302
1.241
1.152
1.088
1.302
1.235
1.208
1.167
1.107
1.064
1.154
1.121
1.107
1.088
1.056
1.033
0.125
0.167
0.250
0.125
0.125
0.125
0.167
0.125
0.167
0.167
0.167
0.250
0.250
0.500
2.4
9800
204
204
9.8
1.03
0.73
9.8
500
422
500
1_000_000_000
18
500
0x7F
0xFF
0xFF
0xFF
0xFF
0xFFFF
0xFF
0.6
0.6
0.6
0.6
401
4729418
2097151
300
300
280
500
22000
65
10000
27
21000
1e7
138
35000
15000
5000
55000
55000
1.e-9
1.e-9
401
412
8000
0x0000
0xc0c1
0xc181
0x0140
0xc301
0x03c0
0x0280
0xc241
0xc601
0x06c0
0x0780
0xc741
0x0500
0xc5c1
0xc481
0x0440
0xcc01
0x0cc0
0x0d80
0xcd41
0x0f00
0xcfc1
0xce81
0x0e40
0x0a00
0xcac1
0xcb81
0x0b40
0xc901
0x09c0
0x0880
0xc841
0xd801
0x18c0
0x1980
0xd941
0x1b00
0xdbc1
0xda81
0x1a40
0x1e00
0xdec1
0xdf81
0x1f40
0xdd01
0x1dc0
0x1c80
0xdc41
0x1400
0xd4c1
0xd581
0x1540
0xd701
0x17c0
0x1680
0xd641
0xd201
0x12c0
0x1380
0xd341
0x1100
0xd1c1
0xd081
0x1040
0xf001
0x30c0
0x3180
0xf141
0x3300
0xf3c1
0xf281
0x3240
0x3600
0xf6c1
0xf781
0x3740
0xf501
0x35c0
0x3480
0xf441
0x3c00
0xfcc1
0xfd81
0x3d40
0xff01
0x3fc0
0x3e80
0xfe41
0xfa01
0x3ac0
0x3b80
0xfb41
0x3900
0xf9c1
0xf881
0x3840
0x2800
0xe8c1
0xe981
0x2940
0xeb01
0x2bc0
0x2a80
0xea41
0xee01
0x2ec0
0x2f80
0xef41
0x2d00
0xedc1
0xec81
0x2c40
0xe401
0x24c0
0x2580
0xe541
0x2700
0xe7c1
0xe681
0x2640
0x2200
0xe2c1
0xe381
0x2340
0xe101
0x21c0
0x2080
0xe041
0xa001
0x60c0
0x6180
0xa141
0x6300
0xa3c1
0xa281
0x6240
0x6600
0xa6c1
0xa781
0x6740
0xa501
0x65c0
0x6480
0xa441
0x6c00
0xacc1
0xad81
0x6d40
0xaf01
0x6fc0
0x6e80
0xae41
0xaa01
0x6ac0
0x6b80
0xab41
0x6900
0xa9c1
0xa881
0x6840
0x7800
0xb8c1
0xb981
0x7940
0xbb01
0x7bc0
0x7a80
0xba41
0xbe01
0x7ec0
0x7f80
0xbf41
0x7d00
0xbdc1
0xbc81
0x7c40
0xb401
0x74c0
0x7580
0xb541
